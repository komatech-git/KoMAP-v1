<!-- templates/map/result.html -->
{% extends "base.html" %}

{% block title %}Map Results{% endblock %}

{% block main %}
<div class="container mx-auto px-4 py-6">
  <h2 class="text-3xl font-semibold mb-6 text-center">Search Results</h2>
  
  <!-- 検索フォームカード -->
  <div class="search-card">
    <form method="post" class="flex flex-col space-y-4">
      {% csrf_token %}
      {{ form.as_table }}
      <button type="submit" class="btn">Search</button>
    </form>
  </div>

  <!-- 検索結果の表示カード -->
  {% if destination %}
  <div id="destination" class="result-card">
    {% if destination|length > 1 %}
      {% for line in destination %}
        <p class="text-gray-800 mb-2">{{ line }}</p>
      {% endfor %}
    {% else %}
      <p class="text-gray-800">{{ destination }}</p>
    {% endif %}
  </div>
  {% endif %}

  <!-- マップ画像カード -->
  {% if room_image_url %}
  <div id="map_picture" class="map-card">
    <img src="{{ room_image_url }}" alt="Map Overview" class="w-full object-cover">
  </div>
  {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<!-- jQuery と jQuery UI の読み込み -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>

<script>
  $(function() {
    // boothフィールドに対してオートコンプリートを有効化
    $('#id_booth').autocomplete({
      source: "{% url 'map:booth-autocomplete' %}",
      minLength: 1,
    });
  });
</script>
{% endblock %}